# 계획 대비 실제 결과 비교

---

## 1. 핵심 KPI

### 학습 루프 횟수

- **계획**: 10회 이상 (Watcher INSTRUCTIONS의 SUPREME OBJECTIVE)
- **실제**: 3회 (v1 → v2 → v3) + Wall FT 패치 (미완료)
- **달성률**: 30%
- **원인**: 루프 1회가 계획의 30~70분이 아니라 3~5시간 소요

### 에피소드 수

- **계획**: 1,000개 (Phase 2 성공 기준)
- **실제**: ~286개 (v1: 10, v2: 52, v3: 200, v5: 24)
- **달성률**: 28.6%
- **원인**: 에피소드당 4~8분 렌더링, 단일 스레드 생성

### Rollout 성공률

- **계획**: 명시적 수치 없음 (Loop 3에서 일반 케이스 70%+ 목표)
- **실제**: 0% (closed-loop 추론에서 한 번도 성공 못함)
- **원인**: covariate shift, ImageNet norm 불일치, wall stuck

### 오프라인 메트릭

- **계획**: Loss 지속 감소, best checkpoint 확보
- **실제**: Loss 0.000080 (Ep473), Holdout MAE 0.0059 — **계획 이상으로 달성**
- **문제**: 오프라인 메트릭과 실제 성능 사이 괴리

### 시연 영상

- **계획**: 학습된 ACT 모델이 LEGO를 자율 수거하는 영상 최소 1개
- **실제**: 미확보 (rollout 0% → 성공 시연 불가)
- **달성률**: 0%

---

## 2. 타임라인 비교

### Phase 0-1: 시뮬레이터 구축

- **계획**: 20:00~22:00 (2시간)
- **실제**: 20:00~21:00 (1시간) — **계획보다 1시간 빠름**
- **비고**: Loop 1 에피소드(7/10 레고 수거, 65초)까지 1시간 만에 완성

### Phase 2: 배치 생성 + LeRobot 변환

- **계획**: 22:00~02:00 (4시간), 1,000 에피소드 + HDF5 변환 + A100 전송
- **실제**: 22:00~23:15 (1시간 15분), 52 에피소드 + HDF5 변환
- **차이**: 목표 1,000개 → 52개로 95% 축소. DomainExpert→Developer 파일 전송 실패(GCS scope)로 우회 필요

### Phase 3: ACT 학습

- **계획**: 02:00~06:00 (4시간), 1,000 에피소드 기반 500 epochs
- **실제**: 23:15~04:28 (5시간 13분), 50 에피소드 기반 500 epochs
- **차이**: 계획보다 3시간 일찍 시작했지만, 에피소드 수가 1/20. 학습 자체는 계획과 비슷한 시간 소요

### Phase 4: Humanoid RL (병렬)

- **계획**: 03:00~06:00 (3시간)
- **실제**: 미착수
- **원인**: rollout 실패 디버깅에 전체 시간 투입

### Phase 5: 문서화 + 데모

- **계획**: 06:00~08:00 (2시간)
- **실제**: 08:00~ (시간 부족으로 부분 진행)
- **비고**: Wall FT가 아직 진행 중이어서 최종 결과 미확정

---

## 3. 사이클별 비교

### 계획 (Watcher INSTRUCTIONS 기준)

- **Cycle 1** (21:30~22:00): 5ep, 10 epochs, 30분
- **Cycle 2** (22:00~22:30): 10ep, 20 epochs, 30분
- **Cycle 3** (22:30~23:00): 15ep, 30 epochs, 30분
- **Cycle 4** (23:00~23:45): 25ep, 50 epochs, 45분
- **Cycle 5** (23:45~00:30): 40ep, 50 epochs, 45분
- **Cycle 6** (00:30~01:30): 50ep, 80 epochs, 60분
- **Cycle 7** (01:30~02:40): 75ep, 100+ epochs, 70분
- **Cycle 8** (02:40~03:50): 100ep, 150+ epochs, 70분
- **Cycle 9** (03:50~05:00): 100+ep, 200+ epochs, 70분
- **Cycle 10** (05:00~06:00): best data 혼합, 최장 학습, 60분

### 실제

- **Loop 1** (20:38~21:00): ~10ep, 검증만, 22분 — **계획보다 빠름**
- **Loop 2** (22:00~04:28): 52ep, 500 epochs, **6시간 28분** — 계획의 Cycle 2~9 전체 시간 소비
- **Loop 3** (04:30~08:44): 200ep, finetune 100+50+10 epochs, **4시간 14분**
- **Loop 4 (Wall FT)**: 24ep, 10 epochs, 진행 중 — 미완료

### 핵심 차이

- 계획: 사이클당 30~70분, 점진적 에피소드 증가 (5 → 100)
- 실제: Loop 2에서 500 epochs full training을 돌려버려서 5시간+ 소비
- 계획의 Tier 1 전략 ("5개 에피소드 + 10 epochs로 빠르게 증명")을 따랐다면 rollout 문제를 훨씬 일찍 발견했을 것

---

## 4. 에이전트별 비교

### Watcher (지휘자)

- **계획**: 5분 간격 능동적 상태 체크, 사이클 전환, 병목 시 VM 스케일링
- **실제**: 22:17~22:50 33분 침묵, 이후 정상 작동. VM 스케일링은 한 번도 실행하지 않음
- **평가**: 타임라인 관리 기능은 동작했지만, 병렬화 지시와 스케일링 결정을 내리지 못함

### Developer (개발자)

- **계획**: 시뮬레이터 구축 → 배치 1,000ep 생성 → LeRobot 변환
- **실제**: 시뮬레이터 구축(예정보다 빠름) → 52ep 생성 → rollout 실패 후 v3/v5 적응형 데이터 생성
- **평가**: 시뮬레이터 구축은 우수. 배치 생성 병렬화 미실행이 가장 큰 아쉬움

### DomainExpert (도메인 전문가)

- **계획**: FMEA 기반 200~300종 시나리오 생성, Evaluation 피드백으로 FMEA 레지스트리 갱신
- **실제**: 13개 "action-rich" 시나리오 (v1), 이후 v4(15개) + anti-ambiguity patch(20개)
- **달성률**: 시나리오 수 기준 ~48개 / 200~300개 목표 = ~20%
- **비고**: GCS scope 문제로 21:00에 첫 파일 전송 실패, 이후 Developer가 자체 시나리오로 대체

### Training (학습)

- **계획**: 사이클별 10~200+ epochs, 점진적 학습, 매 사이클 30분~70분 내 완료
- **실제**: v2 500 epochs (5시간 13분), v3 finetune 100+50 epochs, Wall FT 10 epochs
- **평가**: 첫 학습을 500 epochs로 가버린 것이 시간 낭비의 핵심. 계획대로 10 epochs로 시작했어야 함

### Evaluation (평가)

- **계획**: 체크포인트 수신 후 20분 내 평가, Loop 2부터 시뮬레이터 실행 평가 (rollout)
- **실제**: 오프라인 평가는 정상 수행. 액션 분포 편향(bucket 76% zero, lift 84% zero) 조기 발견
- **평가**: 오프라인 분석은 우수했지만, rollout 평가가 Loop 2 중반(03:10)에야 시작됨

---

## 5. 인프라 비교

### VM 구성

- **계획**: 5대 기본 + 병목 시 Developer VM 최대 3대 추가, Evaluator 추가 가능
- **실제**: 5대 고정, 추가 VM 0대
- **비고**: 에피소드 생성 병목이 명확했지만 스케일링 결정이 내려지지 않음

### 안전장치

- **계획**: 3중 안전장치 (systemd → watchdog timer → 로컬 Mac cron)
- **실제**: 1~2층은 정상 작동. 3층(로컬 Mac cron)은 03:54 KST gcloud auth 만료로 기능 상실
- **비고**: SSH key 직접 사용으로 우회했지만 자동 복구 기능 소실

### GCS 핸드오프

- **계획**: 에이전트 간 GCS 버킷으로 산출물 교환, 사이클별 디렉토리 분리
- **실제**: GCS scope 문제로 DomainExpert→Developer 전송 실패, Discord tarball로 우회
- **비고**: 핸드오프 체인의 첫 번째 구간에서 장애 발생

---

## 6. 데이터 전략 비교

### 시나리오 설계

- **계획**: FMEA 기반 32개 고장모드, Tier 1~3 분류, SPS 점수 기반 우선순위
- **실제**: FMEA 프레임워크는 설계 완료했으나, 실제 시나리오 생성은 13개에 그침
- **비고**: 체계적 시나리오 설계보다 Developer의 자체 시나리오가 더 많이 사용됨

### 데이터 분포

- **계획**: 일반 35% + Tier 1 30% + Tier 2 25% + Tier 3 10%
- **실제**: v1~v2는 일반 시나리오 위주, v3부터 recovery 시퀀스 추가, v5에서 wall-aware 추가
- **비고**: 계획의 체계적 분포 대신 rollout 실패 기반 반응적(reactive) 데이터 추가

### Domain Randomization

- **계획**: 모든 시나리오에 시각/물리/환경 랜덤화 범위 적용 (Tobin et al. 2017)
- **실제**: 기본 환경 변형만 적용, 체계적 Domain Randomization은 미구현
- **비고**: 시간 부족으로 우선순위에서 밀림

---

## 7. 학습 파라미터 비교

### ACT Config

- **계획 = 실제**: chunk_size 20, batch_size 64, lr 1e-4, ResNet18, action_dim 4 — 동일하게 적용
- **차이점**: epochs만 다름 (계획: 사이클별 10~200 / 실제: 첫 학습 500)

### 카메라

- **계획**: ego 주 시점, 필요시 birds_eye 추가 (5시점 녹화 후 학습에는 1~2시점)
- **실제**: ego 단일 시점만 학습에 사용 — 계획과 동일

### 데이터 포맷

- **계획**: MP4 + JSONL → LeRobot HDF5 + Parquet
- **실제**: HDF5 변환 완료 (lerobot_data_v1.hdf5, v2.hdf5) — 계획대로

---

## 8. 평가 체계 비교

### 오프라인 평가

- **계획**: Loss, MSE, 액션 분포 분석, 과적합 감지
- **실제**: 모두 수행. bucket 76% zero-action 등 편향 조기 발견 — **계획 이상**

### 시뮬레이터 실행 평가 (Rollout)

- **계획**: Loop 2부터 10개 고정 시나리오로 수거 성공률/완주율/효율성 측정
- **실제**: Loop 2 중반(03:10)에 첫 rollout 테스트 → 0% 성공 → 이후 원인 분석에 전념
- **차이**: 계획의 체계적 10개 시나리오 평가가 아닌, 디버깅 모드로 전환

### 실패 유형 분류

- **계획**: F1~F6 6가지 유형으로 분류
- **실제**: LIFTING_LOOP_TRAP, WALL_STUCK 두 가지 주요 패턴 식별
- **매핑**: LIFTING_LOOP_TRAP ≈ F4(진동/루프), WALL_STUCK ≈ F5(충돌/끼임)

---

## 9. 비용 비교

### 예상 vs 실제

- **VM 비용 예상**: ~$20 — 실제도 비슷할 것으로 추정
- **API 비용 예상**: $50~100 — 루프가 3회에 그쳤으므로 계획의 10회 대비 낮을 가능성
- **총 비용 예상**: $70~120 — 정확한 청구액은 GCP Billing + API Console 확인 필요

### 비용 효율성

- **A100 GPU**: 40GB 중 3.4GB 사용 (8.5%) → T4/L4로 1/3~1/5 비용 가능
- **에이전트 대화**: 13시간 자율 대화의 API 비용이 VM 비용의 2.5~5배
- **미사용 예산**: VM 스케일링을 한 번도 실행하지 않음 → 추가 Developer VM 예산이 남음

---

## 10. 종합 평가

### 계획이 맞았던 것

- **Vertical Slice First 전략 자체는 옳았다** — 실제로 Loop 1을 1시간 만에 완성
- **5-에이전트 구조**: 역할 분리와 Discord 기반 자율 협업은 작동함
- **FMEA 프레임워크**: 체계적 시나리오 설계 방법론은 건전했음
- **3중 안전장치**: 1~2층은 정상 작동, 에이전트 생존에 기여

### 계획이 틀렸던 것

- **1,000 에피소드 목표**: 생성 속도 측정 없이 설정 → 물리적으로 불가능
- **사이클당 시간 추정**: 30~70분으로 계획했지만 실제 3~5시간
- **첫 학습 500 epochs**: Tier 1 전략(10 epochs)을 따르지 않음 → 5시간 낭비
- **Rollout을 1루프부터 안 돌림**: 오프라인 메트릭만 보고 진행 → 5시간 후 0% 발견
- **Recovery 데이터 미포함**: Expert-only 데이터의 한계를 사전에 인지하지 못함

### 계획에 없었지만 필요했던 것

- **Throughput 사전 벤치마크**: "에피소드 1개 = X분" 측정
- **Rollout 검증을 게이트 조건에 포함**: "오프라인 Loss < X" 외에 "rollout > 0%" 필수
- **DAgger 스타일 데이터 수집**: Expert + perturbation + recovery를 1루프부터
- **에피소드 생성 병렬화**: multi-process headless 렌더링
- **gcloud 토큰 갱신 전략**: 장시간 세션에서의 인증 만료 대비
